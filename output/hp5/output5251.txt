 I bet he did it the day you saw him there, Harry. Sturgis had Moody’s Invisibility Cloak, right? So what if he was standing guard by the door, invisible, and Malfoy heard him move, or guessed he was there, or just did the Imperius Curse on the off chance that a guard was there? So when Sturgis next had an opportunity — probably when it was his turn on  SEEN AND UNFORESEEN guard duty again — he tried to get into the department to steal the weapon for Voldemort — Ron, be quiet — but he got caught and sent to Azkaban. .